# ========================================================================
# ENGR 4350/6350 — Homework 2 (1D Bar Element Stiffness)
# Trey Brown — Fall 2025
# ========================================================================

import numpy as np

# ----------------------------------------------------------------------
# Material and geometry parameters
# ----------------------------------------------------------------------
E = 1.0e5                 # Young's modulus
x1 = 0.0                  # Element start
x2 = 3.0                  # Element end
J = (x2 - x1) / 2.0       # Jacobian (dx/dξ)

# ----------------------------------------------------------------------
# Shape function derivatives
# ----------------------------------------------------------------------
dN_dxi = np.array([-0.5, 0.5])
dN_dx = dN_dxi / J
B = dN_dx.reshape(1, 2)       # Row vector

# ----------------------------------------------------------------------
# Compute BᵀB
# ----------------------------------------------------------------------
BTB = B.T @ B

# ----------------------------------------------------------------------
# Area function A(x)
# ----------------------------------------------------------------------
def A(x):
    return 1 + 0.05 * x**2

# ----------------------------------------------------------------------
# 2-point Gauss quadrature setup
# ----------------------------------------------------------------------
gauss_pts = np.array([-1/np.sqrt(3), 1/np.sqrt(3)])
weights   = np.array([1.0, 1.0])

# ----------------------------------------------------------------------
# Integral of A(x) over element
# ----------------------------------------------------------------------
integral = 0.0
for xi, w in zip(gauss_pts, weights):
    # Map ξ → x
    x = (x2 - x1)/2 * xi + (x1 + x2)/2
    integral += w * A(x)

integral *= J  # multiply by Jacobian

# ----------------------------------------------------------------------
# Element stiffness matrix
# ----------------------------------------------------------------------
Ke = E * BTB * integral

# ----------------------------------------------------------------------
# Display result
# ----------------------------------------------------------------------
print("Element stiffness matrix Ke:")
print(Ke)
